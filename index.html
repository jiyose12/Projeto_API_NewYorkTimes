<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>JS Project NYT API</title>

  <link href="css/plugins.css" rel="stylesheet">
  <link href="css/geral.css" rel="stylesheet">

</head>
<body onload="loadGetInfo()">
	<header>
	<div class="container">
			<div class="logo">
				<img src="images/LogoOngBayeux.png" alt="Logo Topo Tag">
			</div>
			
			<div class="links">
				<nav>
					<ul>
						<li><a href="index.html">Home</a></li>
						<li><a href="#">About</a></li>
						<li><a href="#">Contact</a></li>
					</ul>
				</nav>

			<ul class="social">
				<li><a href="#"><i class="fa fa-facebook"></i></a></li>
				<li><a href="#"><i class="fa fa-youtube"></i></a></li>
				<li><a href="#"><i class="fa fa-instagram"></i></a></li>
			</ul>
			</div>
			

			<h1>Javascript <strong>Project</strong> New York Times <strong>API</strong></h1>
		</div>
	</header>

	<section class="filtros">
		<input id="pesquisa" placeholder="Key Word"type="text">
		<input id="inicio_data" placeholder="DDMMAAAA" type="text">
		<input id="fim_data" placeholder="DDMMAAAA" type="text">
    <button id="botaopesquisa">Pesquisar</button>

		<checkbox>Newest</checkbox>
		<checkbox>Oldest</checkbox>
	</section>

	 <section id="noticias_recentes">
    <div class="container">
      <ul class="itens">
        
      </ul>
    </div>
    </section>

 <script src="dist/bundle.js"></script>

<script type="text/javascript">
  const pesquisa = document.querySelector('#pesquisa');
    const inicio_data = document.querySelector('#inicio_data');
    const fim_data = document.querySelector('#fim_data');
    const botaopesquisa = document.querySelector('#botaopesquisa');
    const noticias_recentes = document.querySelector('#noticias_recentes .container .itens');
    loadGetInfoEvent();
    function loadGetInfoEvent(){
      botaopesquisa.onclick = function(){
        loadGetInfo();
      }
    }

    function loadGetInfo(){
      let url = `https://api.nytimes.com/svc/search/v2/articlesearch.json?api-key=8ff00e2c3ac145d093c95d8a403071fc&sort=newest`;
      getJSON( url, loadSearchInfo );
    }
    function loadSearchInfo( json ){
      let searchinfo = JSON.parse( json );
      console.log(searchinfo);
      //Inserindo no html
      let noticiasRecentes = '';
      for(let field of searchinfo.response.docs){
        noticiasRecentes += `<li>${field.headline.main}</li><li>${field.snippet}</li><li>${field.web_url}</li><li>${field.pub_date}</li>`;

        noticias_recentes.innerHTML = noticiasRecentes;
      }
      //fim da inserção no html
    }
     function getJSON( url, callback ){
      let xhr = new XMLHttpRequest();
      xhr.onload = () => callback( xhr.responseText );
      xhr.open( 'GET', url );
      xhr.send();
    }

</script>
</body>
</html>
